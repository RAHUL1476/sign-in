Lyte.Component.register("lyte-editor-toolbar", {
	data: function () {
		return {
			toolsInstance: Lyte.attr('object', { default: {} }),//No I18n
			toolbar: Lyte.attr('array'),
			tools: Lyte.attr('object'),
			tooltipConfig: Lyte.attr('string'),
			currentToolbarData: Lyte.attr('object'),//No I18n
			connectedEditor: Lyte.attr('object')//No I18n
		}
	},
	init: function () {
		this.setData('tooltipConfig', JSON.stringify({
			position: 'bottom',
			showdelay: 500,
			appearance: 'box',
			margin: 5,
			maxdisplaytime: 3000
		}));
	},
	connectWith: function (object) {
		for (let key in object) {
			const node = object[key];
			switch (key) {
				case 'editor': {
					const data = node.getData();
					this.setData({
						connectedEditor: node,
						toolsInstance: data.toolsInstance,
						currentToolbarData: data.currentToolbarData,
						toolbar: data.providedToolbarData
					});
				}
			}
		}
	},
	overrideTools: function () {
		const toolsInstance = this.data.toolsInstance;
		const tools = _led.overrideTools(this.data.toolbar, this.data.currentToolbarData, toolsInstance);
		this.setData('tools', tools);//No I18n
	},
	triggerEventInEditor: function () {
		const connectedEditor = this.data.connectedEditor;
		const args = Array.from(arguments);
		if (connectedEditor) {
			connectedEditor.triggerAction.apply(connectedEditor.component, args.slice(1));
		} else {
			this.throwEvent.apply(this, args);
		}
	},
	toolsObserver: function () {
		if (this.data.toolbar && this.data.currentToolbarData) {
			this.overrideTools();
		}
	}.observes('toolbar', 'currentToolbarData').on('init'),//No I18n
	actions: {
		triggerAction: function (tool, node, event) {
			const preventEventThrowFor = [
				//ignorei18n_start
				'fontSize',
				'toggleDarkMode'
				//ignorei18n_end
			]
			if (!preventEventThrowFor.includes(tool.triggerAction)) {
				this.triggerEventInEditor('triggerEditorAction', tool.triggerAction, tool.current, tool, node, event);//No I18n
			}
		}
	},
	methods: {
		alterFontSize: function (tool, node, event, selectedValue) {
			this.triggerEventInEditor('triggerEditorAction', 'fontSize', selectedValue, tool, node, event);//No I18n
		},
		changeMode: function (tool, node, input, checkbox, event) {
			const theme = input.checked ? _led.DARK_THEME : _led.LIGHT_THEME;
			this.triggerEventInEditor('triggerEditorAction', 'theme', theme, tool, node, event);//No I18n
		}
	},
	utils: function () {
		const utils = {
			getInfoOfTool: function (toolName) {
				const tools = this.data.tools;
				for (let alignment in tools) {
					if (tools[alignment].hasOwnProperty(toolName)) {
						return tools[alignment][toolName];
					}
				}
				return null;
			}
		}
		for (let util in utils) {
			if (_led.checkType.function(utils[util])) {
				this.$node[util] = utils[util].bind(this);
			} else {
				this.$node[util] = utils[util];
			}
		}
		this.disposeUtils = function () {
			for (let util in utils) {
				delete this.$node[util];
			}
		}
	}.on('init')
});