'use strict';
require = global.require;
var fileManipulation = require('@zoho/lyte-cli-utils').fileManipulation,
    path = require('path');
function replacer (args, options) {
  args.splice(0, 1);
  const [regexOrString, replaceWith, folder] = args;
  const pattern = new RegExp(regexOrString, 'g');
  if (fileManipulation.fileExist(folder)) {
    console.log('replacing ' + pattern + ' with ' + replaceWith);
    var files = [];
    if (fileManipulation.lstatSync(folder).isDirectory()) {
      files = fileManipulation.getFilesListSync(folder)
    } else {
      files = path.isAbsolute(folder) ? [folder] : [path.join(process.cwd(), folder)];
    }
    var content;
    files.forEach(function (file) {
      content = fileManipulation.readSync(file, 'utf8').replace(pattern, replaceWith);
      fileManipulation.writeSync(file, content, true);
    });
  } else {
    console.log('There is no such folder or file');
  }
}
module.exports = replacer;