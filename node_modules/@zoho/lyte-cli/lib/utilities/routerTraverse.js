const {fileManipulation} = require("@zoho/lyte-cli-utils");
const espree = require("espree");
module.exports = function(routerFile) {
    let routerBaseUrl;
    if(fileManipulation.fileExist(routerFile)) {
        let node = espree.parse(fileManipulation.readSync(routerFile,'utf-8'),{
            ecmaVersion :8
        });
        let body = node.body;
        let flag = 1;
        for(let i =0,len =body.length;(flag && i < len) ;i++) {
            let iBody = body[i];
            if(iBody.type == "ExpressionStatement" && iBody.expression.type == "CallExpression" && (callee = iBody.expression.callee) && (property = callee.property) && property.type == "Identifier" && property.name == "configureDefaults") {
                let args = iBody.expression.arguments;
                for(let j =0,len = args.length; (flag && j < len);j++) {
                    let jArgs = args[j];
                    if(jArgs.type == "ObjectExpression") {
                        let p = jArgs.properties;
                        for(let z = 0,len = p.length; z < len;z++ ) {
                            zp = p[z];
                            let key = zp.key
                            if(key.type == "Identifier" && key.name == "baseURL") {
                                routerBaseUrl = zp.value.value || zp.value.name;
                                flag = 0;
                                break;
                            }
                        }
                    }
                }
    
            }
        }
    }
    return routerBaseUrl;
}
